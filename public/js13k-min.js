var w=w||{};w.VERSION="0.0.1";w.plugins=undefined;w.t=undefined;w.create=function(e,n,t,r,i){var d={};var u=1;d.canvas=document.createElement("canvas");d.canvas.setAttribute("width",e*u);d.canvas.setAttribute("height",n*u);d.canvas.style.backgroundColor="black";document.body.appendChild(d.canvas);d.canvas.i=d.canvas.getContext("2d");d.u=s();d.o=g();d.key=b();d.buttons=[];d.l=false;d.s=[];d.v=[];d.state=undefined;d.load=i||undefined;d.g=t||undefined;if(d.g===undefined){throw new Error("Please supply the setup function in the constructor")}d.h=r||undefined;d.paused=false;d.m=60;d.F=Date.now();d.p=1e3/d.m;d.A=0;d.C=true;d.M=[];d.scale=1;function f(){requestAnimationFrame(f,d.canvas);if(d.m===undefined){a();d.k(d.canvas,0)}else{var e=Date.now(),n=e-d.F;if(n>1e3)n=d.p;d.F=e;d.A+=n;while(d.A>=d.p){o();a();d.A-=d.p}var t=d.A/d.p;d.k(d.canvas,t)}}function o(){d.u.children.forEach(function(e){n(e)});function n(e){e.D=e.x;e.S=e.y;if(e.children&&e.children.length>0){e.children.forEach(function(e){n(e)})}}}function a(){if(d.buttons.length>0){d.canvas.style.cursor="auto";for(var e=d.buttons.length-1;e>=0;e--){var n=d.buttons[e];n.update(d.o,d.canvas);if(n.state==="over"||n.state==="down"){if(!n.u){d.canvas.style.cursor="pointer"}}}}if(d.l){d.o.O()}if(d.state&&!d.paused){d.state()}if(d.M.length!==0){for(var t=0;t<d.M.length;t++){var r=d.M[t];r()}}}d.start=function(){if(d.h){d.q.j=function(){d.state=undefined;d.g()};d.q.load(d.h);if(d.load){d.state=d.load}}else{d.g()}f()};d.pause=function(){d.paused=true};d.resume=function(){d.paused=false};d.H=function(){d.canvas.style.cursor="none"};d.I=function(){d.canvas.style.cursor="auto"};Object.defineProperties(d,{L:{get:function(){return d.m},set:function(e){d.m=e;d.F=Date.now();d.p=1e3/d.m},P:true,R:true},backgroundColor:{set:function(e){d.canvas.style.backgroundColor=e},P:true,R:true}});function l(i){i.x=0;i.y=0;i.Y=0;i.B=0;i.width=0;i.height=0;i.X=1;i.G=1;i.N=.5;i.T=.5;i.rotation=0;i.visible=true;i.parent=undefined;i.u=false;i.U=false;i.shadowColor="rgba(100, 100, 100, 0.5)";i.shadowOffsetX=3;i.shadowOffsetY=3;i.shadowBlur=3;i.W=undefined;i.J=1;i.$=undefined;i.K=0;i.V=false;i.Z=false;i.D=undefined;i.S=undefined;i.children=[];i._=function(e){if(e.parent){e.parent.removeChild(e)}e.parent=i;i.children.push(e)};i.removeChild=function(e){if(e.parent===i){i.children.splice(i.children.indexOf(e),1)}else{throw new Error(e+"is not a child of "+i)}};i.ee=function(e,n){var t=i.children.indexOf(e),r=i.children.indexOf(n);if(t!==-1&&r!==-1){e.ne=r;n.ne=t;i.children[t]=n;i.children[r]=e}else{throw new Error(child+" Both objects must be a child of the caller "+i)}};i.add=function(e){var n=Array.prototype.slice.call(arguments);if(n.length>1){n.forEach(function(e){i._(e)})}else{i._(n[0])}};i.remove=function(e){var n=Array.prototype.slice.call(arguments);if(n.length>1){n.forEach(function(e){i.removeChild(e)})}else{i.removeChild(n[0])}};i.setPosition=function(e,n){i.x=e;i.y=n};var r=i;i.te=function(e,n,t){n=n||0;t=t||0;e.x=r.x+r.re-e.re+n;e.y=r.y+r.ie-e.ie+t;i.ue(r,e)};i.fe=function(e,n,t){n=n||0;t=t||0;e.x=r.x+r.re-e.re+n;e.y=r.y-e.height+t;i.ue(r,e)};i.oe=function(e,n,t){n=n||0;t=t||0;e.x=r.x+r.width+n;e.y=r.y+r.ie-e.ie+t;i.ue(r,e)};i.ae=function(e,n,t){n=n||0;t=t||0;e.x=r.x+r.re-e.re+n;e.y=r.y+r.height+t;i.ue(r,e)};i.le=function(e,n,t){n=n||0;t=t||0;e.x=r.x-e.width+n;e.y=r.y+r.ie-e.ie+t;i.ue(r,e)};i.ue=function(e,n){if(n.parent.ce!==0||n.parent.se!==0){n.x-=e.ce;n.y-=e.se}};Object.defineProperties(i,{ce:{get:function(){if(this.parent){return this.x+this.parent.ce}else{return this.x}},P:true,R:true},se:{get:function(){if(this.parent){return this.y+this.parent.se}else{return this.y}},P:true,R:true},position:{get:function(){return{x:i.x,y:i.y}},P:true,R:true},alpha:{get:function(){var e=i.parent.J*i.J;return e},set:function(e){i.J=e},P:true,R:true},re:{get:function(){return i.width/2},P:true,R:true},ie:{get:function(){return i.height/2},P:true,R:true},de:{get:function(){return i.x+i.re},P:true,R:true},ve:{get:function(){return i.y+i.ie},P:true,R:true},ge:{get:function(){return i.K},set:function(e){i.K=e;i.parent.children.sort(m)},P:true,R:true},he:{get:function(){return i.V},set:function(e){if(e===true&&i.V===false){c(i);i.V=true}if(e===false&&i.V===true){delete i.be;delete i.me;i.V=false}},P:true,R:true},draggable:{get:function(){return i.$},set:function(e){if(e===true){d.s.push(i);i.$=true;if(d.l===false)d.l=true}if(e===false){d.s.splice(d.s.indexOf(i),1)}},P:true,R:true},we:{get:function(){return i.Z},set:function(e){if(e===true){v(i);i.Z=true}if(e===false){d.buttons.splice(d.buttons.indexOf(i),1);i.Z=false}},P:true,R:true},xe:{get:function(){var e={x:0,y:0,width:i.width,height:i.height};return e},P:true,R:true},Fe:{get:function(){rectangle={x:i.ce,y:i.se,width:i.ce+i.width,height:i.se+i.height};return rectangle},P:true,R:true},empty:{get:function(){if(i.children.length===0){return true}else{return false}},P:true,R:true}})}d.remove=function(e){var n=Array.prototype.slice.call(arguments);if(!(n[0]instanceof Array)){if(n.length>1){n.forEach(function(e){e.parent.removeChild(e)})}else{n[0].parent.removeChild(n[0])}}else{var t=n[0];if(t.length>0){for(var r=t.length-1;r>=0;r--){var i=t[r];i.parent.removeChild(i);t.splice(t.indexOf(i),1)}}}};function c(n){Object.defineProperties(n,{be:{get:function(){return n.width},set:function(e){n.width=e;n.height=e},P:true,R:true},me:{get:function(){return n.width/2},set:function(e){n.width=e*2;n.height=e*2},P:true,R:true}})}function s(){var e={};l(e);e.u=true;e.width=d.canvas.width;e.height=d.canvas.height;e.x=0;e.y=0;e.parent=undefined;return e}d.group=function(e){var n={};l(n);n._=function(e){if(e.parent){e.parent.removeChild(e)}e.parent=n;n.children.push(e);n.pe()};n.removeChild=function(e){if(e.parent===n){n.children.splice(n.children.indexOf(e),1)}else{throw new Error(e+"is not a child of "+n)}n.pe()};n.pe=function(){if(n.children.length>0){n.Ae=0;n.Ce=0;n.children.forEach(function(e){if(e.x+e.width>n.Ae){n.Ae=e.x+e.width}if(e.y+e.height>n.Ce){n.Ce=e.y+e.height}});n.width=n.Ae;n.height=n.Ce}};d.u._(n);if(e){var t=Array.prototype.slice.call(arguments);t.forEach(function(e){n._(e)})}return n};d.ye=function(e,n,t,r,i,u,f){var o={};l(o);o.mask=false;o.width=e||32;o.height=n||32;o.fillStyle=t||"red";o.strokeStyle=r||"none";o.lineWidth=i||0;o.x=u||0;o.y=f||0;d.u._(o);o.k=function(e){e.strokeStyle=o.strokeStyle;e.lineWidth=o.lineWidth;e.fillStyle=o.fillStyle;e.beginPath();e.rect(-o.width*o.N,-o.height*o.T,o.width,o.height);if(o.mask===true){e.clip()}else{if(o.strokeStyle!=="none")e.stroke();if(o.fillStyle!=="none")e.fill()}};return o};d.Me=function(e,n,t,r,i,u){var f={};l(f);f.mask=false;f.width=e||32;f.height=e||32;f.fillStyle=n||"red";f.strokeStyle=t||"none";f.lineWidth=r||"none";f.x=i||0;f.y=u||0;d.u._(f);c(f);f.k=function(e){e.strokeStyle=f.strokeStyle;e.lineWidth=f.lineWidth;e.fillStyle=f.fillStyle;e.beginPath();e.arc(f.me+-f.be*f.N,f.me+-f.be*f.T,f.me,0,2*Math.PI,false);if(f.mask===true){e.clip()}else{if(f.strokeStyle!=="none")e.stroke();if(f.fillStyle!=="none")e.fill()}};return f};d.line=function(e,n,t,r,i,u){var f={};l(f);if(!t&&t!==0)t=0;if(!r&&r!==0)r=0;if(!i&&i!==0)i=32;if(!u&&u!==0)u=32;f.Ee=t;f.ke=r;f.De=i;f.Se=u;f.strokeStyle=e||"red";f.lineWidth=n||1;f.lineJoin="round";d.u._(f);f.k=function(e){e.strokeStyle=f.strokeStyle;e.lineWidth=f.lineWidth;e.lineJoin=f.lineJoin;e.beginPath();e.moveTo(f.Ee,f.ke);e.lineTo(f.De,f.Se);if(f.strokeStyle!=="none")e.stroke();if(f.fillStyle!=="none")e.fill()};return f};d.text=function(e,n,t,r,i){var u={};l(u);u.content=e||"Hello!";u.font=n||"12px sans-serif";u.fillStyle=t||"red";u.textBaseline="top";Object.defineProperties(u,{width:{get:function(){return d.canvas.i.measureText(u.content).width},P:true,R:true},height:{get:function(){return d.canvas.i.measureText("M").width},P:true,R:true}});d.u._(u);u.x=r||0;u.y=i||0;u.k=function(e){e.strokeStyle=u.strokeStyle;e.lineWidth=u.lineWidth;e.fillStyle=u.fillStyle;if(u.width===0)u.width=e.measureText(u.content).width;if(u.height===0)u.height=e.measureText("M").width;e.translate(-u.width*u.N,-u.height*u.T);e.font=u.font;e.textBaseline=u.textBaseline;e.fillText(u.content,0,0)};return u};d.frame=function(e,n,t,r,i){var u={};u.ze=e;u.x=n;u.y=t;u.width=r;u.height=i;return u};d.frames=function(e,n,t,r){var i={};i.ze=e;i.data=n;i.width=t;i.height=r;return i};d.Oe=function(e,n,t,r){var i=d.q[e].source,u=[],f=i.width/n,o=i.height/t,a=f*o;for(var l=0;l<a;l++){var c,s;c=l%f*n;s=Math.floor(l/f)*t;if(r&&r>0){c+=r+r*l%f;s+=r+r*Math.floor(l/f)}u.push([c,s])}return d.frames(e,u,n,t)};d.je=function(e){var n={};if(e===undefined)throw new Error("Sprites require a source");l(n);n.frames=[];n.loop=true;n.qe=0;n.He=function(e){if(!e.ze){if(!(e instanceof Array)){n.Ie=d.q[e];n.source=n.Ie.source;n.Le=n.Ie.frame.x;n.Pe=n.Ie.frame.y;n.width=n.Ie.frame.w;n.height=n.Ie.frame.Re;n.Ye=n.Ie.frame.w;n.Be=n.Ie.frame.Re}else{n.frames=e;n.source=d.q[e[0]].source;n.Le=d.q[e[0]].frame.x;n.Pe=d.q[e[0]].frame.y;n.width=d.q[e[0]].frame.w;n.height=d.q[e[0]].frame.Re;n.Ye=d.q[e[0]].frame.w;n.Be=d.q[e[0]].frame.Re}}else if(e.ze&&!e.data){if(!(d.q[e.ze].source instanceof Image)){throw new Error(e.ze+" is not an image file")}n.source=d.q[e.ze].source;n.Le=e.x;n.Pe=e.y;n.width=e.width;n.height=e.height;n.Ye=e.width;n.Be=e.height}else if(e.ze&&e.data){n.source=d.q[e.ze].source;n.frames=e.data;n.Le=n.frames[0][0];n.Pe=n.frames[0][1];n.width=e.width;n.height=e.height;n.Ye=e.width;n.Be=e.height}};n.He(e);n.Xe=function(e){if(n.frames.length>0){if(n.frames[0]instanceof Array){n.Le=n.frames[e][0];n.Pe=n.frames[e][1]}else if(d.q[n.frames[e]].frame){n.source=d.q[n.frames[e]].source;n.Le=d.q[n.frames[e]].frame.x;n.Pe=d.q[n.frames[e]].frame.y;n.Ye=d.q[n.frames[e]].frame.w;n.Be=d.q[n.frames[e]].frame.Re;n.width=d.q[n.frames[e]].frame.w;n.height=d.q[n.frames[e]].frame.Re}n.qe=e}else{throw new Error("Frame number "+e+"doesn't exist")}};n.x=0;n.y=0;if(n.frames.length>0){d.Ge(n);Object.defineProperty(n,"Ne",{get:function(){return n.qe},P:false,R:false})}d.u._(n);n.k=function(e){e.drawImage(n.source,n.Le,n.Pe,n.Ye,n.Be,-n.width*n.N,-n.height*n.T,n.width,n.height)};return n};d.button=function(e){var n=d.je(e);n.Te="button";v(n);return n};function v(r){r.Ue=r.Ue||undefined;r.release=r.release||undefined;r.We=r.We||undefined;r.Je=r.Je||undefined;r.$e=r.$e||undefined;r.state="up";r.action="";r.pressed=false;r.enabled=true;r.Ke=false;d.buttons.push(r);r.update=function(e,n){if(r.enabled){var t=d.o.Qe(r);if(e.Ve){r.state="up";if(r.Te==="button")r.show(0)}if(t){r.state="over";if(r.frames&&r.frames.length===3&&r.Te==="button"){r.show(1)}if(e.Ze){r.state="down";if(r.Te==="button"){if(r.frames.length===3){r.show(2)}else{r.show(1)}}}}if(r.state==="down"){if(!r.pressed){if(r.Ue)r.Ue();r.pressed=true;r.action="pressed"}}if(r.state==="over"){if(r.pressed){if(r.release)r.release();r.pressed=false;r.action="released";if(d.o._e&&r.$e)r.$e()}if(!r.Ke){if(r.We)r.We();r.Ke=true}}if(r.state==="up"){if(r.pressed){if(r.release)r.release();r.pressed=false;r.action="released"}if(r.Ke){if(r.Je)r.Je();r.Ke=false}}}}}d.ze=function(e){return d.q[e]};d.json=function(e){return d.q[e]};d.Ge=function(t){var r=0,i=0,u=0,f=0,o=undefined,a=false;function e(e){d();if(typeof e!=="string"){t.Xe(e)}else{t.Xe(t.frames.indexOf(e))}}function n(){c([0,t.frames.length-1])}function l(){d();t.Xe(t.Ne)}function c(e){d();u=e[0];f=e[1];i=f-u;if(u===0){i+=1;r+=1}if(i===1){i=2;r+=1}if(!t.L)t.L=12;var n=1e3/t.L;t.Xe(u);if(!a){o=setInterval(s.bind(this),n);a=true}}function s(){if(r<i){t.Xe(t.Ne+1);r+=1}else{if(t.loop){t.Xe(u);r=1}}}function d(){if(o!==undefined&&a===true){a=false;r=0;u=0;f=0;i=0;clearInterval(o)}}t.show=e;t.play=n;t.stop=l;t.en=a;t.nn=c};d.k=function(r,i){var u=r.i;u.clearRect(0,0,r.width,r.height);for(var e=0;e<d.u.children.length;e++){var n=d.u.children[e];f(n)}function f(e){if(e.visible&&e.ce<r.width+e.width&&e.ce+e.width>=-e.width&&e.se<r.height+e.height&&e.se+e.height>=-e.height){u.save();if(d.C){if(e.D!==undefined){e.tn=(e.x-e.D)*i+e.D}else{e.tn=e.x}if(e.S!==undefined){e.rn=(e.y-e.S)*i+e.S}else{e.rn=e.y}}else{e.tn=e.x;e.rn=e.y}u.translate(e.tn+e.width*e.N,e.rn+e.height*e.T);u.globalAlpha=e.alpha;u.rotate(e.rotation);u.scale(e.X,e.G);if(e.U){u.shadowColor=e.shadowColor;u.shadowOffsetX=e.shadowOffsetX;u.shadowOffsetY=e.shadowOffsetY;u.shadowBlur=e.shadowBlur}if(e.W)u.globalCompositeOperation=e.W;if(e.k)e.k(u);if(e.children&&e.children.length>0){u.translate(-e.width*e.N,-e.height*e.T);for(var n=0;n<e.children.length;n++){var t=e.children[n];f(t)}}u.restore()}}};d.q={"in":0,loaded:0,un:["png","jpg","gif","webp"],fn:["ttf","otf","ttc","woff"],on:["mp3","ogg","wav","webm"],an:["json"],j:undefined,load:function(e){console.log("Loading assets...");var l=this;l["in"]=e.length;e.forEach(function(e){var n=e.split(".").pop();if(l.un.indexOf(n)!==-1){var t=new Image;t.addEventListener("load",function(){t.name=e;l[t.name]={source:t,frame:{x:0,y:0,w:t.width,Re:t.height}};l.ln()},false);t.src=e}else if(l.fn.indexOf(n)!==-1){var r=e.split("/").pop().split(".")[0];var i=document.createElement("style");var u="@font-face {font-family: '"+r+"'; src: url('"+e+"');}";i.appendChild(document.createTextNode(u));document.head.appendChild(i);l.ln()}else if(l.on.indexOf(n)!==-1){var f=d.cn(e,l.ln.bind(l));f.name=e;l[f.name]=f}else if(l.an.indexOf(n)!==-1){var o=new XMLHttpRequest;var a={};o.open("GET",e,true);o.addEventListener("readystatechange",function(){if(o.status===200&&o.readyState===4){a=JSON.parse(o.responseText);a.name=e;l[a.name]=a;if(a.frames){l.sn(a,e)}else{l.ln()}}});o.send()}else{console.log("File type not recognized: "+e)}})},sn:function(n,e){var t=this;var r=e.replace(/[^\/]*$/,"");var i=new Image;i.addEventListener("load",u,false);i.src=r+n.dn.ze;function u(){t[r+n.dn.ze]={source:i,frame:{x:0,y:0,w:i.width,Re:i.height}};Object.keys(n.frames).forEach(function(e){t[e]=n.frames[e];t[e].source=i});t.ln()}},ln:function(){var e=this;e.loaded+=1;console.log(e.loaded);if(e["in"]===e.loaded){e["in"]=0;e.loaded=0;e.j()}}};function g(){var l={};l.vn=0;l.gn=0;Object.defineProperties(l,{x:{get:function(){return l.vn/d.scale},P:true,R:true},y:{get:function(){return l.gn/d.scale},P:true,R:true},de:{get:function(){return l.x},P:true,R:true},ve:{get:function(){return l.y},P:true,R:true},position:{get:function(){return{x:l.x,y:l.y}},P:true,R:true}});l.Ze=false;l.Ve=true;l._e=false;l.hn=0;l.elapsedTime=0;l.Ue=undefined;l.release=undefined;l.$e=undefined;l.bn=null;l.mn=0;l.wn=0;l.xn=function(e){l.vn=e.pageX-e.target.offsetLeft;l.gn=e.pageY-e.target.offsetTop;e.preventDefault()};l.Fn=function(e){l.vn=e.targetTouches[0].pageX-d.canvas.offsetLeft;l.gn=e.targetTouches[0].pageY-d.canvas.offsetTop;e.preventDefault()};l.pn=function(e){l.vn=e.pageX-e.target.offsetLeft;l.gn=e.pageY-e.target.offsetTop;l.Ze=true;l.Ve=false;l._e=false;l.hn=Date.now();if(l.Ue)l.Ue();e.preventDefault()};l.An=function(e){l.vn=e.targetTouches[0].pageX-d.canvas.offsetLeft;l.gn=e.targetTouches[0].pageY-d.canvas.offsetTop;l.Ze=true;l.Ve=false;l._e=false;l.hn=Date.now();if(l.Ue)l.Ue();e.preventDefault()};l.Cn=function(e){l.elapsedTime=Math.abs(l.hn-Date.now());if(l.elapsedTime<=200){l._e=true;if(l.$e)l.$e()}l.Ve=true;l.Ze=false;if(l.release)l.release();e.preventDefault()};d.canvas.addEventListener("mousemove",l.xn.bind(l),false);d.canvas.addEventListener("mousedown",l.pn.bind(l),false);window.addEventListener("mouseup",l.Cn.bind(l),false);d.canvas.addEventListener("touchmove",l.Fn.bind(l),false);d.canvas.addEventListener("touchstart",l.An.bind(l),false);window.addEventListener("touchend",l.Cn.bind(l),false);d.canvas.style.touchAction="none";l.Qe=function(e){var n=false;if(!e.he){var t=e.ce,r=e.ce+e.width,i=e.se,u=e.se+e.height,n=l.x>t&&l.x<r&&l.y>i&&l.y<u}else{var f=l.x-(e.ce+e.re),o=l.y-(e.se+e.ie),a=Math.sqrt(f*f+o*o);n=a<e.me}return n};l.O=function(){if(l.Ze){if(l.bn===null){for(var e=d.s.length-1;e>-1;e--){var n=d.s[e];if(n.draggable&&l.Qe(n)){l.mn=l.x-n.ce;l.wn=l.y-n.se;l.bn=n;var t=n.parent.children;t.splice(t.indexOf(n),1);t.push(n);d.s.splice(d.s.indexOf(n),1);d.s.push(n);break}}}else{l.bn.x=l.x-l.mn;l.bn.y=l.y-l.wn}}if(l.Ve){l.bn=null}d.s.some(function(e){if(e.draggable&&l.Qe(e)){d.canvas.style.cursor="pointer";return true}else{d.canvas.style.cursor="auto";return false}})};return l}function h(e){var n={};n.code=e;n.Ze=false;n.Ve=true;n.Ue=undefined;n.release=undefined;n.pn=function(e){if(e.keyCode===n.code){if(n.Ve&&n.Ue)n.Ue();n.Ze=true;n.Ve=false}e.preventDefault()};n.Cn=function(e){if(e.keyCode===n.code){if(n.Ze&&n.release)n.release();n.Ze=false;n.Ve=true}e.preventDefault()};window.addEventListener("keydown",n.pn.bind(n),false);window.addEventListener("keyup",n.Cn.bind(n),false);return n}function b(){var e={};e.yn=h(37);e.Mn=h(38);e.En=h(39);e.kn=h(40);e.Dn=h(32);return e}function m(e,n){if(e.ge<n.ge){return-1}else if(e.ge>n.ge){return 1}else{return 1}}d.Sn=h;d.zn=l;if(w.plugins!==undefined)w.plugins(d);if(w.t!==undefined)w.t(d);return d};window.On=w.create;(function(e,n,t){"use strict";function r(e){if(!e)return;if(!e.setTargetAtTime)e.setTargetAtTime=e.setTargetValueAtTime}if(window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")){window.AudioContext=webkitAudioContext;if(!AudioContext.prototype.hasOwnProperty("createGain"))AudioContext.prototype.createGain=AudioContext.prototype.createGainNode;if(!AudioContext.prototype.hasOwnProperty("createDelay"))AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode;if(!AudioContext.prototype.hasOwnProperty("createScriptProcessor"))AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode;AudioContext.prototype.jn=AudioContext.prototype.createGain;AudioContext.prototype.createGain=function(){var e=this.jn();r(e.gain);return e};AudioContext.prototype.qn=AudioContext.prototype.createDelay;AudioContext.prototype.createDelay=function(e){var n=e?this.qn(e):this.qn();r(n.delayTime);return n};AudioContext.prototype.Hn=AudioContext.prototype.createBufferSource;AudioContext.prototype.createBufferSource=function(){var e=this.Hn();if(!e.start){e.start=function(e,n,t){if(n||t)this.noteGrainOn(e,n,t);else this.noteOn(e)}}if(!e.stop)e.stop=e.noteOff;r(e.playbackRate);return e};AudioContext.prototype.In=AudioContext.prototype.createDynamicsCompressor;AudioContext.prototype.createDynamicsCompressor=function(){var e=this.In();r(e.threshold);r(e.knee);r(e.ratio);r(e.reduction);r(e.attack);r(e.release);return e};AudioContext.prototype.Ln=AudioContext.prototype.createBiquadFilter;AudioContext.prototype.createBiquadFilter=function(){var e=this.Ln();r(e.frequency);r(e.detune);r(e.Q);r(e.gain);return e};if(AudioContext.prototype.hasOwnProperty("createOscillator")){AudioContext.prototype.Pn=AudioContext.prototype.createOscillator;AudioContext.prototype.createOscillator=function(){var e=this.Pn();if(!e.start)e.start=e.noteOn;if(!e.stop)e.stop=e.noteOff;r(e.frequency);r(e.detune);return e}}}})(window);(function(r){"use strict";var e=true,n,t,i={Rn:{enabled:"fullscreenEnabled",Yn:"fullscreenElement",Bn:"requestFullscreen",Xn:"exitFullscreen",Gn:{Nn:"fullscreenchange",error:"fullscreenerror"}},Tn:{enabled:"webkitIsFullScreen",Yn:"webkitCurrentFullScreenElement",Bn:"webkitRequestFullScreen",Xn:"webkitCancelFullScreen",Gn:{Nn:"webkitfullscreenchange",error:"webkitfullscreenerror"}},Un:{enabled:"mozFullScreen",Yn:"mozFullScreenElement",Bn:"mozRequestFullScreen",Xn:"mozCancelFullScreen",Gn:{Nn:"mozfullscreenchange",error:"mozfullscreenerror"}},Wn:{enabled:"msFullscreenEnabled",Yn:"msFullscreenElement",Bn:"msRequestFullscreen",Xn:"msExitFullscreen",Gn:{Nn:"MSFullscreenChange",error:"MSFullscreenError"}}},u=i.Rn;for(t in i){if(i[t].enabled in r){n=i[t];break}}function f(e,n){var t=r.createEvent("Event");t.initEvent(e,true,false);n.dispatchEvent(t)}function o(e){r[u.enabled]=r[n.enabled];r[u.Yn]=r[n.Yn];f(u.Gn.Nn,e.target)}function a(e){f(u.Gn.error,e.target)}if(e&&!(u.enabled in r)&&n){r.addEventListener(n.Gn.Nn,o,false);r.addEventListener(n.Gn.error,a,false);r[u.enabled]=r[n.enabled];r[u.Yn]=r[n.Yn];r[u.Xn]=r[n.Xn];Element.prototype[u.Bn]=function(){return this[n.Bn].apply(this,arguments)}}return n})(document);w=w||{};w.plugins=function(o){o.move=function(e){if(e instanceof Array===false){t(e)}else{for(var n=0;n<e.length;n++){t(e[n])}}};function t(e){e.x+=e.Y|0;e.y+=e.B|0}o.Jn=function(e,n){return Math.floor(Math.random()*(n-e+1))+e};o.$n=function(e){e=e||"#2C3539";var n,t,r,i;n=window.innerWidth/o.canvas.width;t=window.innerHeight/o.canvas.height;r=Math.min(n,t);o.canvas.style.transformOrigin="0 0";o.canvas.style.transform="scale("+r+")";if(o.canvas.width>o.canvas.height){if(o.canvas.width*r<window.innerWidth){i="horizontally"}else{i="vertically"}}else{if(o.canvas.height*r<window.innerHeight){i="vertically"}else{i="horizontally"}}var u;if(i==="horizontally"){u=(window.innerWidth-o.canvas.width*r)/2;o.canvas.style.marginLeft=u+"px";o.canvas.style.marginRight=u+"px"}if(i==="vertically"){u=(window.innerHeight-o.canvas.height*r)/2;o.canvas.style.marginTop=u+"px";o.canvas.style.marginBottom=u+"px"}o.canvas.style.paddingLeft=0;o.canvas.style.paddingRight=0;o.canvas.style.paddingTop=0;o.canvas.style.paddingBottom=0;o.canvas.style.display="block";document.body.style.backgroundColor=e;o.o.scale=r;o.scale=r;o.canvas.Kn=true;var f=navigator.userAgent.toLowerCase();if(f.indexOf("safari")!=-1){if(f.indexOf("chrome")>-1){}else{o.canvas.style.maxHeight="100%";o.canvas.style.minHeight="100%"}}};o.Qn=function(e,n,t,r){var i=n.x,u=n.y,f=n.width,o=n.height;t=t||false;var a;if(e.x<i){if(t)e.Y*=-1;if(e.Vn)e.Y/=e.Vn;e.x=i;a="left"}if(e.y<u){if(t)e.B*=-1;if(e.Vn)e.B/=e.Vn;e.y=u;a="top"}if(e.x+e.width>f){if(t)e.Y*=-1;if(e.Vn)e.Y/=e.Vn;e.x=f-e.width;a="right"}if(e.y+e.height>o){if(t)e.B*=-1;if(e.Vn)e.B/=e.Vn;e.y=o-e.height;a="bottom"}if(a&&r)r(a);return a};o.Zn=function(e,n,t){var r,i,u,f,o;if(t===undefined)t=false;r=false;if(t){f=e.ce+e.re-(n.ce+n.re);o=e.se+e.ie-(n.se+n.ie)}else{f=e.de-n.de;o=e.ve-n.ve}i=e.re+n.re;u=e.ie+n.ie;if(Math.abs(f)<i){if(Math.abs(o)<u){r=true}else{r=false}}else{r=false}return r}};var f=w.create(800,600,e,["assets/astronaut.png","assets/asteroid.png","assets/life.png"]);window.addEventListener("resize",function(e){f.$n()});f.$n();f.start();var o,a,l,c,s,d,v,g,h,b,m,x,F,p,A,C,y,M;var u=5e3;function e(){h=0;f.backgroundColor="#000000";d=f.group();a=[];l=255;var e=120;for(var n=0;n<e;n++){var t=f.Me(1,"white");t.x=f.Jn(0,f.canvas.width);t.y=f.Jn(0,f.canvas.height);a.push(t);d._(t)}var r=1e4;c=f.Me(r,"#4242FF","#DDDDFF8C",30,f.canvas.width/2-r/2,520);c._n=140;d._(c);b=f.je("assets/asteroid.png");b.x=f.Jn(0,f.canvas.width-b.width);b.y=f.canvas.height+100;b.B=-5;b.et=f.Jn(-1e3,1e3)*1e-5;d._(b);o=f.je("assets/astronaut.png");o.X=2;o.G=2;o.x=256-o.re;o.y=100;o.et=0;d._(o);g=f.ye(1,20,"#FFFFFF70");g.x=f.Jn(0,f.canvas.width);g.y=f.canvas.height+10;g.B=-60;d._(g);m=100;p=f.text("Health: 100%","12px Futura","lightgrey",10,10);d._(p);A=f.Me(600+(f.canvas.width+f.canvas.height)/2,"#00000000","#FF000020",500);A.x=Math.round(f.canvas.width/2-A.re);A.y=Math.round(f.canvas.height/2-A.ie);A.visible=false;d._(A);M=f.je("assets/life.png");M.x=f.canvas.width+20;M.y=f.Jn(30,f.canvas.height-M.height-30);M.Y=-3;M.B=f.Jn(-1,1);M.nt=false;M.et=f.Jn(-1e3,1e3)*1e-4;d._(M);var i=f.ye(16,f.canvas.height-60,"black"),u=f.ye(16,f.canvas.height-60,"green");C=f.group(i,u);C.inner=u;C.x=f.canvas.width-30;C.y=30;d._(C);s=f.text("YOU WIN!","64px Futura","lightgrey",f.canvas.width/2-160,f.canvas.height/2-32);v=f.group(s);v.visible=false;F=f.text("YOU LOSE!","64px Futura","red",f.canvas.width/2-170,f.canvas.height/2-32);x=f.group(F);y=f.text("Progress: 0%","24px Futura","red",F.x+80,F.y+80);x._(y);x.visible=false;f.key.w=f.Sn(87);f.key.a=f.Sn(65);f.key.tt=f.Sn(83);f.key.d=f.Sn(68);f.state=E}function E(){if(h++>u){f.state=S}C.inner.height=Math.round(h/u*C.height);f.move(b);b.rotation+=b.et;f.move(o);f.move(M);M.rotation+=M.et;switch(f.Qn(o,f.u.xe)){case"left":case"right":o.Y=0;break;case"top":case"bottom":o.B=0;break;default:}if(b.y<-10-b.height){b.Y=0;b.x=f.Jn(0,f.canvas.width-b.width);b.y=f.canvas.height+100;b.et=f.Jn(-1e3,1e3)*1e-5}var e=.25;var n=.001;if(f.key.w.Ze||f.key.Mn.Ze){o.B-=e;o.et-=n}if(f.key.a.Ze||f.key.yn.Ze){o.Y-=e;o.et-=n}if(f.key.d.Ze||f.key.En.Ze){o.Y+=e;o.et+=n}if(f.key.tt.Ze||f.key.kn.Ze){o.et+=n;o.B+=e}o.rotation+=o.et;if(f.Zn(o,b)){k();D(-1);A.visible=true}else{A.visible=false}if(!M.nt&&f.Zn(o,M)){D(30);M.visible=false;M.nt=true}if((M.nt||M.x>f.canvas.width+50||M.x<-50)&&f.Jn(0,1e3)<2){M.y=f.Jn(30,f.canvas.height-M.height-30);M.B=f.Jn(-1,1);if(f.Jn(0,100)<50){M.x=-20;M.Y=3}else{M.x=f.canvas.width+20;M.Y=-3}M.et=f.Jn(-1e3,1e3)*1e-4;M.nt=false;M.visible=true}if(h%5===0){c.lineWidth+=1}if(h%10===0){c.y-=1;c._n-=1;c._n=Math.max(c._n,0);c.strokeStyle="#DDDDFF"+("0"+c._n.toString(16)).substr(-2);l-=1;l=Math.max(l,0);var t="#FFFFFF"+("0"+l.toString(16)).substr(-2);a.forEach(function(e){e.fillStyle=t})}f.move(g);if(g.y<0){g.x=f.Jn(0,f.canvas.width);g.y=f.canvas.height+10}var r=Math.min(Math.round(h/15),255);var i=Math.round(r/2);f.backgroundColor="#"+("0"+i.toString(16)).substr(-2)+("0"+i.toString(16)).substr(-2)+("0"+r.toString(16)).substr(-2)}function k(){b.Y=Math.sign(b.x-o.x);o.Y+=Math.sign(o.x-b.x);o.B-=.7}function D(e){m+=e;p.content="Health: "+m.toString()+"%";if(m<20){p.fillStyle="red"}else{p.fillStyle="lightgrey"}if(m<=0){f.state=t}}function n(){h=0;o.x=256-o.re;o.y=100;o.et=0;l=255;c.x=f.canvas.width/2-c.be/2;c.y=520;c._n=140;c.lineWidth=30;m=100;p.content="Health: "+m.toString()+"%";p.fillStyle="white";d.visible=true;x.visible=false;v.visible=false}function S(){f.backgroundColor="black";d.visible=false;v.visible=true;if(f.key.Dn.Ze){n();f.state=E}}function t(){y.content="Progress: "+Math.round(100*h/u).toString()+"%";f.backgroundColor="black";d.visible=false;x.visible=true;if(f.key.Dn.Ze){n();f.state=E}}

var container = document.getElementById("js13k");
var cvs = document.getElementsByTagName("canvas");
container.appendChild(cvs[0]);